import{p as Je,aw as Xe,ax as Qe,ay as Ye,g as ea,_ as aa,x as f,s as be,D as Re,o as C,az as la,aA as ta,z as H,X as Oe,aB as na,u as oa,aC as oe,c as t,U as ke,aD as We,H as ue,al as ua,ab as q,aE as sa,aF as Ge,r as ia,ad as x,aG as ra,aH as da,$ as ma,aI as ca,aJ as va,a0 as pa,P as fa,a2 as ga,A as ya,aK as ba,a7 as ne,a8 as u,a6 as j,af as N,ac as de,ag as Le,ae as fe,K as z,an as J,ao as Ke,aj as Va,ai as Fe,am as ze,ap as ka,a9 as Be,av as Ee,aa as Ue,as as Me,ak as xa,au as Ca,at as Ia}from"./index-CpMueqvo.js";import{l as ha}from"./lodash-DHyxJ22h.js";import{C as je}from"./ConfirmDeleteDialogWithTextField-CVgzxDZx.js";import{V as _a}from"./VContainer-C43jOY1J.js";import{a as X,V as Ne}from"./VRow-_iU4zbVk.js";import{m as Da,b as wa,u as Pa,c as Sa,d as Ta,V as qe,a as Aa}from"./VDataTableServer-DhW9m2O0.js";import{V as $e}from"./VForm-BnUMxxmE.js";import{u as Fa,t as Ve,b as Ze,V as he}from"./VList-CuOHXLng.js";import{V as za}from"./VCheckboxBtn-h2o2OYw9.js";import{V as Ba}from"./VTooltip-BeY6VOCx.js";import{T as He}from"./index-D94ZyzME.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VDivider-HQLxwg8b.js";function Ea(n,I,Q){if(I==null)return n;if(Array.isArray(I))throw new Error("Multiple matches is not implemented");return typeof I=="number"&&~I?t(ke,null,[t("span",{class:"v-combobox__unmask"},[n.substr(0,I)]),t("span",{class:"v-combobox__mask"},[n.substr(I,Q)]),t("span",{class:"v-combobox__unmask"},[n.substr(I+Q)])]):n}const Ua=Je({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...Da({filterKeys:["title"]}),...wa({hideNoData:!0,returnObject:!0}),...Xe(Qe({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Ye({transition:!1})},"VCombobox"),Ma=ea()({name:"VCombobox",props:Ua(),emits:{"update:focused":n=>!0,"update:modelValue":n=>!0,"update:search":n=>!0,"update:menu":n=>!0},setup(n,I){var Ie;let{emit:Q,slots:d}=I;const{t:h}=aa(),_=f(),w=be(!1),O=be(!0),me=be(!1),ce=f(),ge=f(),Y=Re(n,"menu"),b=C({get:()=>Y.value,set:o=>{var s;Y.value&&!o&&((s=ce.value)!=null&&s.ΨopenChildren.size)||(Y.value=o)}}),g=be(-1);let se=!1;const ee=C(()=>{var o;return(o=_.value)==null?void 0:o.color}),W=C(()=>b.value?n.closeText:n.openText),{items:P,transformIn:ae,transformOut:ve}=Fa(n),{textColorClasses:ie,textColorStyles:_e}=la(ee),m=Re(n,"modelValue",[],o=>ae(ma(o)),o=>{const s=ve(o);return n.multiple?s:s[0]??null}),le=ta(),A=C(()=>!!(n.chips||d.chip)),S=C(()=>A.value||!!d.selection),y=be(!n.multiple&&!S.value?((Ie=m.value[0])==null?void 0:Ie.title)??"":""),p=C({get:()=>y.value,set:o=>{var s;if(y.value=o??"",!n.multiple&&!S.value&&(m.value=[Ve(n,o)]),o&&n.multiple&&((s=n.delimiters)!=null&&s.length)){const V=o.split(new RegExp(`(?:${n.delimiters.join("|")})+`));V.length>1&&(V.forEach(r=>{r=r.trim(),r&&F(Ve(n,r))}),y.value="")}o||(g.value=-1),O.value=!o}}),te=C(()=>typeof n.counterValue=="function"?n.counterValue(m.value):typeof n.counterValue=="number"?n.counterValue:n.multiple?m.value.length:p.value.length);H(y,o=>{se?Oe(()=>se=!1):w.value&&!b.value&&(b.value=!0),Q("update:search",o)}),H(m,o=>{var s;!n.multiple&&!S.value&&(y.value=((s=o[0])==null?void 0:s.title)??"")});const{filteredItems:L,getMatches:pe}=Pa(n,P,()=>O.value?"":p.value),B=C(()=>n.hideSelected?L.value.filter(o=>!m.value.some(s=>s.value===o.value)):L.value),E=C(()=>m.value.map(o=>o.value)),U=C(()=>{var s;return(n.autoSelectFirst===!0||n.autoSelectFirst==="exact"&&p.value===((s=B.value[0])==null?void 0:s.title))&&B.value.length>0&&!O.value&&!me.value}),i=C(()=>n.hideNoData&&!B.value.length||n.readonly||(le==null?void 0:le.isReadonly.value)),G=f(),re=Sa(G,_);function $(o){se=!0,n.openOnClear&&(b.value=!0)}function xe(){i.value||(b.value=!0)}function ye(o){i.value||(w.value&&(o.preventDefault(),o.stopPropagation()),b.value=!b.value)}function M(o){var s;ca(o)&&((s=_.value)==null||s.focus())}function Ce(o){var r;if(va(o)||n.readonly||le!=null&&le.isReadonly.value)return;const s=_.value.selectionStart,V=m.value.length;if((g.value>-1||["Enter","ArrowDown","ArrowUp"].includes(o.key))&&o.preventDefault(),["Enter","ArrowDown"].includes(o.key)&&(b.value=!0),["Escape"].includes(o.key)&&(b.value=!1),["Enter","Escape","Tab"].includes(o.key)&&(U.value&&["Enter","Tab"].includes(o.key)&&!m.value.some(c=>{let{value:T}=c;return T===B.value[0].value})&&F(L.value[0]),O.value=!0),o.key==="ArrowDown"&&U.value&&((r=G.value)==null||r.focus("next")),o.key==="Enter"&&p.value&&(F(Ve(n,p.value)),S.value&&(y.value="")),["Backspace","Delete"].includes(o.key)){if(!n.multiple&&S.value&&m.value.length>0&&!p.value)return F(m.value[0],!1);if(~g.value){const c=g.value;F(m.value[g.value],!1),g.value=c>=V-1?V-2:c}else o.key==="Backspace"&&!p.value&&(g.value=V-1)}if(n.multiple){if(o.key==="ArrowLeft"){if(g.value<0&&s>0)return;const c=g.value>-1?g.value-1:V-1;m.value[c]?g.value=c:(g.value=-1,_.value.setSelectionRange(p.value.length,p.value.length))}if(o.key==="ArrowRight"){if(g.value<0)return;const c=g.value+1;m.value[c]?g.value=c:(g.value=-1,_.value.setSelectionRange(0,0))}}}function De(){var o;n.eager&&((o=ge.value)==null||o.calculateVisibleItems())}function we(){var o;w.value&&(O.value=!0,(o=_.value)==null||o.focus())}function F(o){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!o||o.props.disabled))if(n.multiple){const V=m.value.findIndex(c=>n.valueComparator(c.value,o.value)),r=s??!~V;if(~V){const c=r?[...m.value,o]:[...m.value];c.splice(V,1),m.value=c}else r&&(m.value=[...m.value,o]);n.clearOnSelect&&(p.value="")}else{const V=s!==!1;m.value=V?[o]:[],y.value=V&&!S.value?o.title:"",Oe(()=>{b.value=!1,O.value=!0})}}function Pe(o){w.value=!0,setTimeout(()=>{me.value=!0})}function Se(o){me.value=!1}function Te(o){(o==null||o===""&&!n.multiple&&!S.value)&&(m.value=[])}return H(w,(o,s)=>{if(!(o||o===s)&&(g.value=-1,b.value=!1,p.value)){if(n.multiple){F(Ve(n,p.value));return}if(!S.value)return;m.value.some(V=>{let{title:r}=V;return r===p.value})?y.value="":F(Ve(n,p.value))}}),H(b,()=>{if(!n.hideSelected&&b.value&&m.value.length){const o=B.value.findIndex(s=>m.value.some(V=>n.valueComparator(V.value,s.value)));na&&window.requestAnimationFrame(()=>{var s;o>=0&&((s=ge.value)==null||s.scrollToIndex(o))})}}),H(()=>n.items,(o,s)=>{b.value||w.value&&!s.length&&o.length&&(b.value=!0)}),oa(()=>{const o=!!(!n.hideNoData||B.value.length||d["prepend-item"]||d["append-item"]||d["no-data"]),s=m.value.length>0,V=oe.filterProps(n);return t(oe,ue({ref:_},V,{modelValue:p.value,"onUpdate:modelValue":[r=>p.value=r,Te],focused:w.value,"onUpdate:focused":r=>w.value=r,validationValue:m.externalValue,counterValue:te.value,dirty:s,class:["v-combobox",{"v-combobox--active-menu":b.value,"v-combobox--chips":!!n.chips,"v-combobox--selection-slot":!!S.value,"v-combobox--selecting-index":g.value>-1,[`v-combobox--${n.multiple?"multiple":"single"}`]:!0},n.class],style:n.style,readonly:n.readonly,placeholder:s?void 0:n.placeholder,"onClick:clear":$,"onMousedown:control":xe,onKeydown:Ce}),{...d,default:()=>t(ke,null,[t(We,ue({ref:ce,modelValue:b.value,"onUpdate:modelValue":r=>b.value=r,activator:"parent",contentClass:"v-combobox__content",disabled:i.value,eager:n.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:n.transition,onAfterEnter:De,onAfterLeave:we},n.menuProps),{default:()=>[o&&t(Ze,ue({ref:G,selected:E.value,selectStrategy:n.multiple?"independent":"single-independent",onMousedown:r=>r.preventDefault(),onKeydown:M,onFocusin:Pe,onFocusout:Se,tabindex:"-1","aria-live":"polite",color:n.itemColor??n.color},re,n.listProps),{default:()=>{var r,c,T;return[(r=d["prepend-item"])==null?void 0:r.call(d),!B.value.length&&!n.hideNoData&&(((c=d["no-data"])==null?void 0:c.call(d))??t(he,{title:h(n.noDataText)},null)),t(Ta,{ref:ge,renderless:!0,items:B.value},{default:Z=>{var a;let{item:D,index:K,itemRef:l}=Z;const e=ue(D.props,{ref:l,key:K,active:U.value&&K===0?!0:void 0,onClick:()=>F(D,null)});return((a=d.item)==null?void 0:a.call(d,{item:D,index:K,props:e}))??t(he,ue(e,{role:"option"}),{prepend:v=>{let{isSelected:k}=v;return t(ke,null,[n.multiple&&!n.hideSelected?t(za,{key:D.value,modelValue:k,ripple:!1,tabindex:"-1"},null):void 0,D.props.prependAvatar&&t(ua,{image:D.props.prependAvatar},null),D.props.prependIcon&&t(q,{icon:D.props.prependIcon},null)])},title:()=>{var v,k;return O.value?D.title:Ea(D.title,(v=pe(D))==null?void 0:v.title,((k=p.value)==null?void 0:k.length)??0)}})}}),(T=d["append-item"])==null?void 0:T.call(d)]}})]}),m.value.map((r,c)=>{function T(l){l.stopPropagation(),l.preventDefault(),F(r,!1)}const Z={"onClick:close":T,onKeydown(l){l.key!=="Enter"&&l.key!==" "||(l.preventDefault(),l.stopPropagation(),T(l))},onMousedown(l){l.preventDefault(),l.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},D=A.value?!!d.chip:!!d.selection,K=D?sa(A.value?d.chip({item:r,index:c,props:Z}):d.selection({item:r,index:c})):void 0;if(!(D&&!K))return t("div",{key:r.value,class:["v-combobox__selection",c===g.value&&["v-combobox__selection--selected",ie.value]],style:c===g.value?_e.value:{}},[A.value?d.chip?t(ia,{key:"chip-defaults",defaults:{VChip:{closable:n.closableChips,size:"small",text:r.title}}},{default:()=>[K]}):t(Ge,ue({key:"chip",closable:n.closableChips,size:"small",text:r.title,disabled:r.props.disabled},Z),null):K??t("span",{class:"v-combobox__selection-text"},[r.title,n.multiple&&c<m.value.length-1&&t("span",{class:"v-combobox__selection-comma"},[x(",")])])])})]),"append-inner":function(){var Z;for(var r=arguments.length,c=new Array(r),T=0;T<r;T++)c[T]=arguments[T];return t(ke,null,[(Z=d["append-inner"])==null?void 0:Z.call(d,...c),(!n.hideNoData||n.items.length)&&n.menuIcon?t(q,{class:"v-combobox__menu-icon",icon:n.menuIcon,onMousedown:ye,onClick:ra,"aria-label":h(W.value),title:h(W.value),tabindex:"-1"},null):void 0])}})}),da({isFocused:w,isPristine:O,menu:b,search:p,selectionIndex:g,filteredItems:L,select:F},_)}}),Na={key:0},$a={class:"d-flex justify-center h-25"},Ra={class:"mb-8"},Oa={class:"text-pink-lighten-2"},La={class:"card-title ps-6 py-3"},Ka={__name:"department",setup(n){const{smAndUp:I,mdAndUp:Q}=fa(),{apiAuth:d}=Ia(),h=ga(),_=C(()=>I.value?"default":"small"),w=f([]),O=C(()=>ye.value.map(l=>({...l,displayName:`${l.name} (${l.companyId})`}))),me=C(()=>{if(!Y.value||!i.value.departmentId)return"(選擇公司、部門代碼後顯示)";let l=i.value.departmentId;return typeof l=="object"&&(l=l.value),l=l.replace(/^[A-Z]\d+/,""),`${Y.value.companyId}${l}`}),ce=[{title:"IT",value:"IT",name:"IT部"},{title:"OP",value:"OP",name:"OP部"},{title:"TO (線控)",value:"TO",name:"線控部"},{title:"AT (機控)",value:"AT",name:"機控部"},{title:"BC (直售)",value:"BC",name:"直售部"},{title:"BB (同業)",value:"BB",name:"同業部"},{title:"BD (商務)",value:"BD",name:"商務部"},{title:"CI (企業獎勵)",value:"CI",name:"企獎部"},{title:"MD (行銷美編)",value:"MD",name:"行銷美編部"},{title:"FM (財務管理)",value:"FM",name:"財務管理部"},{title:"GB (高爾夫球)",value:"GB",name:"高爾夫球事業部"}],ge=()=>{if(typeof i.value.departmentId=="object"){const l=ce.find(e=>e.value===i.value.departmentId.value);l&&(i.value.name=l.name)}b()},Y=C(()=>A.value.find(l=>l._id===i.value.c_id)),b=()=>{if(Y.value&&i.value.departmentId){let l=i.value.departmentId;typeof l=="object"&&(l=l.value),i.value.departmentId=l.replace(/^[A-Z]\d+/,"")}},g=f(0),se=f(!1),ee=f(10),W=f([{key:"departmentId",order:"asc"}]),P=f(1),ae=f(0),ve=f(""),ie=f(""),_e={class:"header-bg"},m=[{title:"部編",key:"departmentId",align:"start",minWidth:"68px",sortable:!0},{title:"公司",key:"c_id.name",align:"start",minWidth:"68px",sortable:!0},{title:"部門",key:"name",align:"start",minWidth:"68px",sortable:!0},{title:"人數",key:"memberCount",align:"start",sortable:!1},{title:"操作",key:"actions",align:"center",sortable:!1}],le=C(()=>I.value?m:m.filter(l=>["departmentId","name","memberCount","actions"].includes(l.key))),A=f([]),S=f({open:!1}),y=f({open:!1,_id:"",companyId:"",name:""}),p=f({open:!1,_id:"",name:""}),te=f({name:""}),L=f([]),pe=f([]),B=f([]),E=f({open:!1,id:null}),U=f({open:!1,id:"",name:"",companyName:""}),i=f({c_id:"",name:"",departmentId:"",hasChanges:!0}),G=f([]),re=f([]),$=f(!1),xe=async()=>{try{const{data:l}=await d.get("/company/all");l.success&&(A.value=l.result)}catch{h({text:"載入公司列表失敗",snackbarProps:{color:"red-lighten-1"}})}},ye=C(()=>[...A.value].sort((l,e)=>{const a=l.companyId||"",v=e.companyId||"";return a.localeCompare(v)})),M=async(l=!1)=>{var e,a;l&&(P.value=1),se.value=!0;try{const v={page:P.value,itemsPerPage:ee.value,sortBy:((e=W.value[0])==null?void 0:e.key)||"departmentId",sortOrder:((a=W.value[0])==null?void 0:a.order)||"asc",companyId:ie.value||null,search:ve.value||null},{data:k}=await d.get("/department/all",{params:v});k.success&&(B.value=k.result.data,ae.value=k.result.pagination.totalItems,console.log("Total items:",ae.value))}catch{h({text:"載入部門列表失敗",snackbarProps:{color:"red-lighten-1"}}),B.value=[],ae.value=0}finally{se.value=!1}},Ce=async()=>{S.value.open=!0,await xe()},De=()=>{S.value.open=!1,te.value={name:""},L.value=[]},we=l=>{y.value={open:!0,_id:l._id,companyId:l.companyId,name:l.name}},F=()=>{y.value={open:!1,id:"",companyId:"",name:""},pe.value=[]},Pe=async()=>{var l,e;if(!te.value.name){L.value=["請輸入公司名稱"];return}$.value=!0;try{const{data:a}=await d.post("/company",{name:te.value.name});a.success&&(A.value.push(a.result),te.value={name:""},L.value=[],h({text:"新增公司成功",snackbarProps:{color:"teal-lighten-1"}}))}catch(a){L.value=[((e=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:e.message)||"新增失敗"]}finally{$.value=!1}},Se=async()=>{var l,e;if(!y.value.name){pe.value=["請輸入公司名稱"];return}$.value=!0;try{const{data:a}=await d.patch(`/company/${y.value._id}`,{name:y.value.name,companyId:y.value.companyId});if(a.success){const v=A.value.findIndex(k=>k._id===y.value._id);v!==-1&&(A.value[v]=a.result),y.value={open:!0,_id:"",companyId:"",name:""},pe.value=[],F(),h({text:"修改公司成功",snackbarProps:{color:"teal-lighten-1"}})}}catch(a){h({text:((e=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:e.message)||"修改失敗",snackbarProps:{color:"red-lighten-1"}})}finally{$.value=!1}},Te=l=>{p.value={open:!0,_id:l._id,name:l.name}},Ie=async()=>{var l,e;try{await d.delete(`/company/${p.value._id}`),A.value=A.value.filter(a=>a._id!==p.value._id),p.value.open=!1,h({text:"刪除公司成功",snackbarProps:{color:"teal-lighten-1"}})}catch(a){h({text:((e=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:e.message)||"刪除失敗",snackbarProps:{color:"red-lighten-1"}})}},o=()=>{E.value.open=!0,i.value={c_id:"",name:"",departmentId:"",hasChanges:!0,originalData:null}},s=()=>{E.value={open:!1,id:null},i.value={c_id:"",name:"",departmentId:"",originalData:null,hasChanges:!1},G.value=[],re.value=[],w.value=[]},V=l=>{var k;E.value={open:!0,id:l._id};const e=((k=l.c_id)==null?void 0:k._id)||l.c_id,a=l.departmentId.replace(/^[A-Z]\d+/,""),v=ce.find(R=>R.value===a);i.value={c_id:e,name:l.name,departmentId:v||a,originalData:{c_id:e,name:l.name,departmentId:l.departmentId},hasChanges:!1}},r=async()=>{var v,k;if(G.value=[],re.value=[],w.value=[],!i.value.c_id){re.value=["請選擇公司"];return}if(!i.value.name){G.value=["請輸入部門名稱"];return}if(!i.value.departmentId){w.value=["請輸入部門代碼"];return}let l=i.value.departmentId;if(typeof l=="object"&&(l=l.value),!Y.value){re.value=["請先選擇公司"];return}const e=me.value;$.value=!0;const a=P.value;try{if(E.value.id){const{data:R}=await d.patch(`/department/${E.value.id}`,{c_id:i.value.c_id,name:i.value.name,departmentId:e});R.success&&(s(),h({text:"修改部門成功",snackbarProps:{color:"teal-lighten-1"}}),P.value=a,await M(!1))}else{const{data:R}=await d.post("/department",{c_id:i.value.c_id,name:i.value.name,departmentId:e});R.success&&(await M(!0),s(),h({text:"新增部門成功",snackbarProps:{color:"teal-lighten-1"}}))}}catch(R){const Ae=((k=(v=R==null?void 0:R.response)==null?void 0:v.data)==null?void 0:k.message)||"操作失敗";Ae.includes("部門代碼已存在")?w.value=["此部門代碼已存在"]:Ae.includes("部門名稱已存在")?G.value=["此部門名稱已存在"]:h({text:Ae,snackbarProps:{color:"red-lighten-1"}})}finally{$.value=!1}},c=l=>{var e;U.value={open:!0,id:l._id,name:l.name,companyName:((e=l.c_id)==null?void 0:e.name)||"未知公司"}},T=async()=>{var l,e;try{const a=P.value;await d.delete(`/department/${U.value.id}`),U.value.open=!1,ae.value--;const v=Math.ceil(ae.value/ee.value);a>v?P.value=Math.max(1,v):P.value=a,await M(!1),h({text:"刪除部門成功",snackbarProps:{color:"teal-lighten-1"}})}catch(a){h({text:((e=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:e.message)||"刪除失敗",snackbarProps:{color:"red-lighten-1"}})}},Z=C(()=>i.value.originalData?i.value.c_id!==i.value.originalData.c_id||i.value.name!==i.value.originalData.name||i.value.departmentId!==i.value.originalData.departmentId:!0),D=async l=>{const{page:e,itemsPerPage:a,sortBy:v}=l;P.value=e,ee.value=a,W.value=v,await M(!1),localStorage.setItem("departmentTablePage",e.toString())},K=ha.debounce(()=>{M(!0)},300);return H(ie,()=>{M(!0)}),H(ve,()=>{P.value=1,K()}),H([ee,W],()=>{M(!0)}),H(ie,()=>{P.value=1,M(!0)}),H(()=>i.value.c_id,()=>{i.value.departmentId&&b()}),ya(async()=>{const l=localStorage.getItem("departmentTablePage");l&&parseInt(l)>0&&(P.value=parseInt(l),g.value++),await xe(),await M(!1)}),ba(()=>{localStorage.setItem("departmentTablePage",P.value.toString()),K.cancel()}),(l,e)=>(j(),ne(_a,{"max-width":"1400"},{default:u(()=>[t(Ne,{class:"elevation-4 rounded-xl py-4 py-sm-8 px-1 px-sm-10 mt-2 mt-sm-6 mx-0 mx-sm-4 mx-md-10 mb-4 bg-white"},{default:u(()=>[t(X,{cols:"12",class:"ps-3 pb-6 d-flex align-center"},{default:u(()=>[e[16]||(e[16]=N("h3",null,"公司部門管理",-1)),de(I)?Le((j(),ne(q,{key:0,icon:"mdi-information",size:"small",color:"blue-grey-darken-2",class:"ms-4"},null,512)),[[He,"人數為「在職」人數"]]):fe("",!0)]),_:1}),t(X,{cols:"12"},{default:u(()=>[t(Ne,null,{default:u(()=>[t(X,null,{default:u(()=>[t(Ne,null,{default:u(()=>[de(Q)?fe("",!0):(j(),ne(X,{key:0,cols:"6"},{default:u(()=>[t(z,{"prepend-icon":"mdi-domain",variant:"outlined",color:"blue-grey-darken-2",class:"me-2",block:"",onClick:Ce},{default:u(()=>e[17]||(e[17]=[x(" 公司管理 ")])),_:1})]),_:1})),de(Q)?fe("",!0):(j(),ne(X,{key:1,cols:"6"},{default:u(()=>[t(z,{"prepend-icon":"mdi-account-multiple-plus",variant:"outlined",color:"blue-grey-darken-2",block:"",onClick:o},{default:u(()=>e[18]||(e[18]=[x(" 新增部門 ")])),_:1})]),_:1})),de(Q)?(j(),ne(X,{key:2},{default:u(()=>[t(z,{"prepend-icon":"mdi-domain",variant:"outlined",color:"blue-grey-darken-2",class:"me-2",onClick:Ce},{default:u(()=>e[19]||(e[19]=[x(" 公司管理 ")])),_:1}),t(z,{"prepend-icon":"mdi-account-multiple-plus",variant:"outlined",color:"blue-grey-darken-2",class:"ms-3",onClick:o},{default:u(()=>e[20]||(e[20]=[x(" 新增部門 ")])),_:1})]),_:1})):fe("",!0),t(X,{cols:"6",md:"3",lg:"2"},{default:u(()=>[t(qe,{modelValue:ie.value,"onUpdate:modelValue":[e[0]||(e[0]=a=>ie.value=a),e[1]||(e[1]=a=>M(!0))],items:[{name:"全部",_id:""},...ye.value],label:"選擇公司","item-title":"name","item-value":"_id",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue","items"])]),_:1}),t(X,{cols:"6",md:"3",lg:"2",class:"d-flex justify-end align-center"},{default:u(()=>[de(I)?Le((j(),ne(q,{key:0,icon:"mdi-information",size:"small",color:"blue-grey-darken-2",class:"me-4"},null,512)),[[He,"可搜尋部門編號、部門名稱","top"]]):fe("",!0),t(oe,{modelValue:ve.value,"onUpdate:modelValue":e[2]||(e[2]=a=>ve.value=a),label:"搜尋","append-inner-icon":"mdi-magnify",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(X,{cols:"12"},{default:u(()=>[(j(),ne(Aa,{key:g.value,"items-per-page":ee.value,"onUpdate:itemsPerPage":e[3]||(e[3]=a=>ee.value=a),"sort-by":W.value,"onUpdate:sortBy":e[4]||(e[4]=a=>W.value=a),items:B.value,"items-length":ae.value,loading:se.value,page:P.value,headers:le.value,"header-props":_e,density:"compact","items-per-page-options":[10,20,50],hover:"","onUpdate:options":D},{item:u(({item:a,index:v})=>{var k;return[N("tr",{class:Va({"odd-row":v%2===0,"even-row":v%2!==0})},[N("td",null,J(a.departmentId||"尚未設定"),1),de(I)?(j(),Ke("td",Na,J(((k=a.c_id)==null?void 0:k.name)||"未設定"),1)):fe("",!0),N("td",null,J(a.name),1),N("td",null,J(a.employeeCount)+" 人",1),N("td",$a,[t(z,{icon:"",color:"light-blue-darken-4",variant:"plain",size:_.value,ripple:!1,onClick:R=>V(a)},{default:u(()=>[t(q,null,{default:u(()=>e[21]||(e[21]=[x("mdi-pencil")])),_:1})]),_:2},1032,["size","onClick"]),t(z,{icon:"",color:"red-lighten-1",variant:"plain",size:_.value,ripple:!1,onClick:R=>c(a)},{default:u(()=>[t(q,null,{default:u(()=>e[22]||(e[22]=[x("mdi-delete")])),_:1})]),_:2},1032,["size","onClick"])])],2)]}),_:1},8,["items-per-page","sort-by","items","items-length","loading","page","headers"]))]),_:1})]),_:1})]),_:1})]),_:1}),t(Me,{modelValue:S.value.open,"onUpdate:modelValue":e[6]||(e[6]=a=>S.value.open=a),persistent:"",width:"395"},{default:u(()=>[t(Fe,{class:"rounded-lg pa-4"},{default:u(()=>[e[28]||(e[28]=N("div",{class:"card-title ps-6 py-3"}," 公司管理 ",-1)),t(ze,{class:"px-4 pb-2"},{default:u(()=>[N("div",Ra,[(j(!0),Ke(ke,null,ka(ye.value,a=>(j(),ne(Ge,{key:a._id,class:"ms-2 me-4 mb-2 pa-4 pe-1",color:"blue-grey-darken-2",label:""},{default:u(()=>[N("span",Oa,J(a.companyId)+" ",1),x(" "+J(a.name)+" ",1),t(We,null,{activator:u(({props:v})=>[t(z,ue({icon:"",size:"x-small",variant:"text",class:"ms-2",ripple:!1,color:"white",ref_for:!0},v),{default:u(()=>[t(q,{color:"cyan-darken-3"},{default:u(()=>e[23]||(e[23]=[x(" mdi-dots-vertical ")])),_:1})]),_:2},1040)]),default:u(()=>[t(Ze,{density:"compact"},{default:u(()=>[t(he,{density:"compact",class:"ps-2 pe-3 py-0",onClick:v=>we(a)},{default:u(()=>[t(q,{icon:"mdi-pencil",size:"16",color:"light-blue-darken-4"}),e[24]||(e[24]=N("span",{style:{"font-size":"14px"},class:"ps-2 text-blue-grey-darken-2"},"編輯",-1))]),_:2},1032,["onClick"]),t(he,{density:"compact",class:"ps-2 pe-3 py-0",color:"red-lighten-1",onClick:v=>Te(a)},{default:u(()=>[t(q,{icon:"mdi-delete",size:"16",color:"red-lighten-1"}),e[25]||(e[25]=N("span",{style:{"font-size":"14px"},class:"ps-2 text-blue-grey-darken-2"},"刪除",-1))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),t($e,{onSubmit:Be(Pe,["prevent"])},{default:u(()=>[t(oe,{modelValue:te.value.name,"onUpdate:modelValue":e[5]||(e[5]=a=>te.value.name=a),"error-messages":L.value,label:"新增公司",required:"",variant:"outlined",density:"compact",class:"px-2"},null,8,["modelValue","error-messages"]),t(Ee,{class:"pa-0 mt-2"},{default:u(()=>[t(Ue),t(z,{color:"red-lighten-1",variant:"outlined",size:_.value,onClick:De},{default:u(()=>e[26]||(e[26]=[x(" 取消 ")])),_:1},8,["size"]),t(z,{color:"teal-darken-1",variant:"outlined",type:"submit",size:_.value,loading:$.value,class:"ms-2"},{default:u(()=>e[27]||(e[27]=[x(" 新增 ")])),_:1},8,["size","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Me,{modelValue:y.value.open,"onUpdate:modelValue":e[9]||(e[9]=a=>y.value.open=a),persistent:"",width:"400"},{default:u(()=>[t(Fe,{class:"rounded-lg pa-4"},{default:u(()=>[t(xa,{class:"text-h6 ps-4 py-3"},{default:u(()=>e[29]||(e[29]=[x(" 編輯公司 ")])),_:1}),t(ze,null,{default:u(()=>[t($e,{onSubmit:Be(Se,["prevent"])},{default:u(()=>[t(oe,{modelValue:y.value.companyId,"onUpdate:modelValue":e[7]||(e[7]=a=>y.value.companyId=a),label:"公司編號",variant:"outlined",density:"compact",class:"mb-4"},null,8,["modelValue"]),t(oe,{modelValue:y.value.name,"onUpdate:modelValue":e[8]||(e[8]=a=>y.value.name=a),"error-messages":pe.value,label:"公司名稱",required:"",variant:"outlined",density:"compact"},null,8,["modelValue","error-messages"]),t(Ee,{class:"pa-0 mt-4"},{default:u(()=>[t(Ue),t(z,{color:"red-lighten-1",variant:"outlined",onClick:F},{default:u(()=>e[30]||(e[30]=[x(" 取消 ")])),_:1}),t(z,{color:"teal-darken-1",variant:"outlined",type:"submit",loading:$.value,class:"ms-2"},{default:u(()=>e[31]||(e[31]=[x(" 修改 ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Me,{modelValue:E.value.open,"onUpdate:modelValue":e[13]||(e[13]=a=>E.value.open=a),persistent:"",width:"360"},{default:u(()=>[t(Fe,{class:"rounded-lg px-4 pt-4 pb-1"},{default:u(()=>[N("div",La,J(E.value.id?"編輯部門":"新增部門"),1),t(ze,null,{default:u(()=>[t($e,{onSubmit:Be(r,["prevent"])},{default:u(()=>[t(qe,{modelValue:i.value.c_id,"onUpdate:modelValue":e[10]||(e[10]=a=>i.value.c_id=a),items:O.value,label:"選擇公司","item-title":"displayName","item-value":"_id",required:"",variant:"outlined",density:"compact",class:"mb-4","error-messages":re.value},null,8,["modelValue","items","error-messages"]),t(Ma,{modelValue:i.value.departmentId,"onUpdate:modelValue":[e[11]||(e[11]=a=>i.value.departmentId=a),ge],items:ce,"item-title":"title","item-value":"value",label:"部門代碼",required:"",variant:"outlined",density:"compact",class:"mb-1","error-messages":w.value,clearable:""},Ca({_:2},[de(I)?{name:"append-inner",fn:u(()=>[t(Ba,{location:"top","close-delay":"200"},{activator:u(({props:a})=>[t(q,ue(a,{icon:"mdi-information",size:"18"}),null,16)]),default:u(()=>[e[32]||(e[32]=x(" 可選擇預設部門代碼或自行輸入 "))]),_:1})]),key:"0"}:void 0]),1032,["modelValue","error-messages"]),t(oe,{class:"mb-2 text-grey-darken-1",variant:"outlined",density:"compact",readonly:"","persistent-placeholder":"",label:"部門編號預覽"},{default:u(()=>[x(J(me.value),1)]),_:1}),t(oe,{modelValue:i.value.name,"onUpdate:modelValue":e[12]||(e[12]=a=>i.value.name=a),label:"部門名稱",required:"",variant:"outlined",density:"compact","error-messages":G.value},null,8,["modelValue","error-messages"]),t(Ee,{class:"pa-0 mt-4"},{default:u(()=>[t(Ue),t(z,{color:"red-lighten-1",variant:"outlined",size:_.value,onClick:s},{default:u(()=>e[33]||(e[33]=[x(" 取消 ")])),_:1},8,["size"]),t(z,{color:"teal-darken-1",variant:"outlined",size:_.value,type:"submit",loading:$.value,disabled:E.value.id?!Z.value:!1,class:"ms-2"},{default:u(()=>[x(J(E.value.id?"修改":"新增"),1)]),_:1},8,["size","loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(je,{modelValue:p.value.open,"onUpdate:modelValue":e[14]||(e[14]=a=>p.value.open=a),title:"確認刪除公司",message:`確定要刪除公司「<span class='text-pink-lighten-1' style='font-weight: 800;'>${p.value.name}</span>」嗎？此操作無法復原。`,"expected-name":p.value.name,"input-label":"公司名稱",onConfirm:Ie},null,8,["modelValue","message","expected-name"]),t(je,{modelValue:U.value.open,"onUpdate:modelValue":e[15]||(e[15]=a=>U.value.open=a),title:"確認刪除部門",message:`確定要刪除「<span class='text-teal-darken-2' style='font-weight: 800;'>${U.value.companyName}</span>」的「<span class='text-pink-lighten-1' style='font-weight: 800;'>${U.value.name}</span>」嗎？此操作無法復原。`,"expected-name":U.value.name,"input-label":"部門名稱",onConfirm:T},null,8,["modelValue","message","expected-name"])]),_:1}))}},tl=pa(Ka,[["__scopeId","data-v-a693d0fb"]]);export{tl as default};
