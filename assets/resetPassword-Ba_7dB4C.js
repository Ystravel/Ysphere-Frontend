import{_ as y,Z as V,x as l,A as k,ak as C,c as o,a4 as r,a0 as _,$,a2 as B,a5 as E,a9 as c,ar as b,ab as F,K as I,av as N}from"./index-eCTZU4da.js";import{V as R}from"./VContainer-BbaT7v1W.js";import{V as S}from"./VForm-DSUxJfjB.js";import{V as A,a as m}from"./VRow-BXF5YFMd.js";const M={id:"background",class:"fill-height d-flex justify-center align-center"},T={__name:"resetPassword",setup(U){const v=_(),w=$(),{api:P}=N(),f=V(),s=l({newPassword:"",confirmPassword:""}),i=l(!1),u=l(!1),n=l(""),d=l(""),p=l(!1);k(async()=>{v.params.token||(f({text:"無效的重置連結",snackbarProps:{color:"error"}}),w.push("/login"))});const g=()=>{let t=!0;return n.value="",d.value="",s.value.newPassword?s.value.newPassword.length<8&&(n.value="密碼長度至少需要8個字元",t=!1):(n.value="請輸入新密碼",t=!1),s.value.confirmPassword?s.value.newPassword!==s.value.confirmPassword&&(d.value="兩次輸入的密碼不相符",t=!1):(d.value="請確認新密碼",t=!1),t},x=async()=>{var t,e;if(g())try{p.value=!0;const{data:a}=await P.post("/user/reset-password",{token:v.params.token,newPassword:s.value.newPassword});f({text:a.message,snackbarProps:{color:"teal-lighten-1"}}),w.push("/login")}catch(a){f({text:((e=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:e.message)||"重置密碼失敗",snackbarProps:{color:"red-lighten-1"}})}finally{p.value=!1}};return(t,e)=>(B(),C("div",M,[o(R,{class:"reset-password-wrapper pa-0",style:{"max-width":"360px"}},{default:r(()=>[o(S,{disabled:p.value,onSubmit:E(x,["prevent"])},{default:r(()=>[o(A,{class:"px-4 ma-0"},{default:r(()=>[o(m,{cols:"12",class:"text-center mt-4 font-weight-bold"},{default:r(()=>e[6]||(e[6]=[c(" 重置密碼 ")])),_:1}),o(m,{cols:"12"},{default:r(()=>[o(b,{modelValue:s.value.newPassword,"onUpdate:modelValue":[e[0]||(e[0]=a=>s.value.newPassword=a),e[2]||(e[2]=a=>n.value="")],"error-messages":n.value,type:i.value?"text":"password","append-inner-icon":i.value?"mdi-eye-off":"mdi-eye",label:"新密碼",density:"compact",variant:"underlined",autocomplete:"new-password","onClick:appendInner":e[1]||(e[1]=a=>i.value=!i.value)},null,8,["modelValue","error-messages","type","append-inner-icon"])]),_:1}),o(m,{cols:"12"},{default:r(()=>[o(b,{modelValue:s.value.confirmPassword,"onUpdate:modelValue":[e[3]||(e[3]=a=>s.value.confirmPassword=a),e[5]||(e[5]=a=>d.value="")],"error-messages":d.value,type:u.value?"text":"password","append-inner-icon":u.value?"mdi-eye-off":"mdi-eye",label:"確認新密碼",density:"compact",variant:"underlined",autocomplete:"new-password","onClick:appendInner":e[4]||(e[4]=a=>u.value=!u.value)},null,8,["modelValue","error-messages","type","append-inner-icon"])]),_:1}),o(m,{cols:"12",class:"pb-8"},{default:r(()=>[e[8]||(e[8]=F("div",{class:"text-body-2 text-medium-emphasis mb-6"}," 新密碼必須至少8個字元 ",-1)),o(I,{block:"",elevation:"2",color:"blue-grey-darken-2",type:"submit",loading:p.value,disabled:!s.value.newPassword||!s.value.confirmPassword},{default:r(()=>e[7]||(e[7]=[c(" 重置密碼 ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1})]))}},z=y(T,[["__scopeId","data-v-137014e9"]]);export{z as default};
