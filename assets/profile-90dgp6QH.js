import{x as _,Y as j,Z as G,P as M,o as N,a1 as v,ai as I,aa as p,ab as q,a2 as b,a3 as l,a$ as K,a9 as w,a8 as t,K as V,c as e,a6 as R,_ as Y,am as Z,U as H,ad as S,af as O,V as Q,a7 as d,ah as i,as as u,ag as X,a4 as h,aq as ee,a5 as le}from"./index-D4IdPBTv.js";import{c as ae}from"./Company-BwWfcO28.js";import{T as se}from"./index-8h1KsN4F.js";import{V as te}from"./VContainer-CG-V8FRT.js";import{V as n,a as s}from"./VRow-BZ7Q9aCd.js";import{V as de}from"./VDivider-C9-Xhgzh.js";import{V as ne}from"./VForm-CoVmVrzR.js";import"./VTooltip-CbV_SdWg.js";const L={__name:"FileUploadButton",setup(W){const x=_(null),U=j(),P=G(),g=_(!1),{width:$}=M(),z=N(()=>$.value>=1500),B=async y=>{const f=y.target.files[0];if(!f)return;if(!["image/jpeg","image/png"].includes(f.type)){P({text:"只能上傳 JPG、PNG、WEBP 格式的圖片",snackbarProps:{color:"error"}});return}if(f.size>2*1024*1024){P({text:"圖片大小不能超過 2MB",snackbarProps:{color:"error"}});return}const r=new FormData;r.append("image",f);try{g.value=!0,await U.updateAvatar(r),P({text:"大頭貼更新成功",snackbarProps:{color:"success"}})}catch(k){P({text:k.message||"上傳失敗",snackbarProps:{color:"error"}})}finally{g.value=!1,y.target.value=""}};return(y,f)=>(v(),I("div",null,[p("input",{ref_key:"fileInput",ref:x,type:"file",accept:"image/jpeg,image/png",style:{display:"none"},onChange:B},null,544),z.value?q((v(),b(V,{key:0,"prepend-icon":"mdi-camera-outline",color:"blue-grey-darken-2",variant:"outlined",loading:g.value,onClick:f[0]||(f[0]=r=>y.$refs.fileInput.click())},{default:l(()=>[g.value?(v(),b(K,{key:0,indeterminate:"",size:"20",width:"2",color:"teal-lighten-1",class:"me-2"})):w("",!0),f[2]||(f[2]=t(" 更換大頭貼 "))]),_:1},8,["loading"])),[[se,"檔案不超過2MB。格式僅限JPG、PNG、WEBP。","top"]]):(v(),b(V,{key:1,color:"blue-grey-darken-2",size:"24",elevation:"0",rounded:"xl",loading:g.value,onClick:f[1]||(f[1]=r=>y.$refs.fileInput.click())},{default:l(()=>[e(R,{icon:"mdi-camera-outline",size:"14"})]),_:1},8,["loading"]))]))}},oe={class:"text-h6 mb-3 opacity-90"},re={class:"text-subtitle-2 mb-4 opacity-70"},ue={style:{"font-size":"15px","font-weight":"600"},class:"opacity-90 mb-12"},ie={key:0,class:"text-subtitle-2 opacity-80 font-weight-regular"},me={__name:"profile",setup(W){const{mdAndUp:x,width:U,smAndUp:P}=M(),g=N(()=>U.value>=1500),$=N(()=>o.guideLicense?"有":"無"),z=N(()=>P.value?"default":"small"),B=m=>ae[m]||"未知公司",y=_(!1),f=_(!1),r=_({currentPassword:"",newPassword:"",confirmPassword:""}),k=_(""),C=_(""),D=_(""),o=j(),F=G(),T=m=>m?new Date(m).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}):"",J=()=>{let m=!0;return r.value.currentPassword||(k.value="請輸入當前密碼",m=!1),r.value.newPassword?r.value.newPassword.length<8&&(C.value="新密碼長度至少需要8個字元",m=!1):(C.value="請輸入新密碼",m=!1),r.value.confirmPassword?r.value.newPassword!==r.value.confirmPassword&&(D.value="兩次輸入的密碼不相符",m=!1):(D.value="請確認新密碼",m=!1),m},A=async()=>{if(J())try{f.value=!0;const m=await o.changePassword(r.value.currentPassword,r.value.newPassword);F({text:m.message,snackbarProps:{color:"teal-lighten-1"}}),E()}catch(m){F({text:m.message,snackbarProps:{color:"red-lighten-1"}})}finally{f.value=!1}},E=()=>{y.value=!1,r.value={currentPassword:"",newPassword:"",confirmPassword:""},k.value="",C.value="",D.value=""};return(m,a)=>(v(),I(H,null,[e(te,{"max-width":"2200"},{default:l(()=>[e(n,null,{default:l(()=>[g.value?(v(),b(s,{key:0,md:"3"},{default:l(()=>[e(n,{class:"elevation-4 rounded-xl pt-8 pb-10 px-1 px-sm-10 mt-2 mt-sm-10 mx-10 bg-white"},{default:l(()=>[e(S,{width:"100%",elevation:"0"},{default:l(()=>[e(n,{class:"text-center"},{default:l(()=>[e(s,{cols:"12"},{default:l(()=>[e(O,{size:"100"},{default:l(()=>[e(Q,{src:d(o).avatar},null,8,["src"])]),_:1})]),_:1}),e(s,null,{default:l(()=>[p("div",oe,i(d(o).name),1),p("div",re,i(d(o).userId),1),p("div",ue,i(d(o).jobTitle),1),e(L)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):w("",!0),e(s,{xl:"9"},{default:l(()=>[e(n,{class:"elevation-4 rounded-xl pt-8 pb-6 px-1 px-sm-10 mt-2 mt-sm-10 mx-0 mx-sm-4 ms-xl-0 me-xl-10 mb-4 bg-white"},{default:l(()=>[e(s,{cols:"12",class:"d-flex justify-space-between"},{default:l(()=>[p("h3",null,[a[10]||(a[10]=t(" 個人資料管理   ")),d(x)?(v(),I("span",ie,a[9]||(a[9]=[p("span",{class:"text-red-darken-2"},"* ",-1),t("若有需要修改 請聯絡人資 ( 密碼可自行修改 )")]))):w("",!0)]),p("div",null,[e(n,null,{default:l(()=>[e(s,null,{default:l(()=>[d(x)?(v(),b(V,{key:0,color:"blue-grey-darken-2","prepend-icon":"mdi-pencil",variant:"outlined",height:"36",onClick:a[0]||(a[0]=c=>y.value=!0)},{default:l(()=>a[11]||(a[11]=[t(" 修改密碼 ")])),_:1})):w("",!0)]),_:1}),d(x)?w("",!0):(v(),b(s,{key:0},{default:l(()=>[e(V,{color:"blue-grey-darken-2","prepend-icon":"mdi-pencil",variant:"outlined",size:"small",height:"32",onClick:a[1]||(a[1]=c=>y.value=!0)},{default:l(()=>a[12]||(a[12]=[t(" 修改密碼 ")])),_:1})]),_:1})),g.value?w("",!0):(v(),b(s,{key:1,class:"d-flex align-center"},{default:l(()=>[e(L)]),_:1}))]),_:1})])]),_:1}),d(x)?w("",!0):(v(),b(s,{key:0,cols:"12"},{default:l(()=>a[13]||(a[13]=[p("span",{class:"text-subtitle-2 opacity-80 font-weight-regular"},[p("span",{class:"text-red-darken-2"},"* "),t("若有需要修改 請聯絡人資 ( 密碼可自行修改 )")],-1)])),_:1})),e(s,null,{default:l(()=>[e(de)]),_:1}),e(s,{cols:"12",class:"mt-3 mb-6 text-center text-blue-grey-darken-3"},{default:l(()=>a[14]||(a[14]=[p("div",{class:"profile-subtitle"}," 《 基本資料 》 ",-1)])),_:1}),e(s,{cols:"12"},{default:l(()=>[e(n,{class:"text-blue-grey-darken-3"},{default:l(()=>[e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[15]||(a[15]=[t(" 姓名 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:""},{default:l(()=>[t(i(d(o).name),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[16]||(a[16]=[t(" 英文名 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:""},{default:l(()=>[t(i(d(o).englishName),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[17]||(a[17]=[t(" 生日 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:""},{default:l(()=>[t(i(T(d(o).birthDate)),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[18]||(a[18]=[t(" 性別 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:""},{default:l(()=>[t(i(d(o).gender),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[19]||(a[19]=[t(" 手機號碼 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:""},{default:l(()=>[t(i(d(o).cellphone),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[20]||(a[20]=[t(" Email : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:""},{default:l(()=>[t(i(d(o).email),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",md:"6",lg:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[21]||(a[21]=[t(" 戶籍地址 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:"",class:"address-style"},{default:l(()=>[t(i(d(o).permanentAddress),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",md:"6",lg:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[22]||(a[22]=[t(" 聯絡地址 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:"",class:"address-style"},{default:l(()=>[t(i(d(o).contactAddress),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0 pe-0"},{default:l(()=>a[23]||(a[23]=[t(" 緊急聯絡人 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:""},{default:l(()=>[t(i(d(o).emergencyName),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[24]||(a[24]=[t(" 緊急連絡人電話 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:""},{default:l(()=>[t(i(d(o).emergencyCellphone),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{cols:"12",class:"mt-3 mb-6 text-center text-blue-grey-darken-3"},{default:l(()=>a[25]||(a[25]=[p("div",{class:"profile-subtitle"}," 《 任職資料 》 ",-1)])),_:1}),e(s,{cols:"12"}),e(n,{class:"text-blue-grey-darken-3"},{default:l(()=>[e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[26]||(a[26]=[t(" 員工編號 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:""},{default:l(()=>[t(i(d(o).userId),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[27]||(a[27]=[t(" 所屬公司 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:"",value:B(d(o).department.companyId)},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[28]||(a[28]=[t(" 部門 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:""},{default:l(()=>[t(i(d(o).department.name),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[29]||(a[29]=[t(" 入職日期 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:""},{default:l(()=>[t(i(T(d(o).hireDate)),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[30]||(a[30]=[t(" 分機號碼 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:""},{default:l(()=>[t(i(d(o).extNumber),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[31]||(a[31]=[t(" 列印編號 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:""},{default:l(()=>[t(i(d(o).printNumber),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{class:"py-0 mb-6",cols:"12",sm:"6",md:"4"},{default:l(()=>[e(n,null,{default:l(()=>[e(s,{cols:"3",sm:"12",class:"align-self-center py-0"},{default:l(()=>a[32]||(a[32]=[t(" 領隊證 : ")])),_:1}),e(s,{cols:"9",sm:"12"},{default:l(()=>[e(u,{variant:"outlined",density:"compact","hide-details":"",readonly:"",value:$.value},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(Z,{modelValue:y.value,"onUpdate:modelValue":a[8]||(a[8]=c=>y.value=c),"max-width":"360"},{default:l(()=>[e(S,null,{default:l(()=>[a[35]||(a[35]=p("div",{class:"card-title ps-6 py-6"}," 修改密碼 ",-1)),e(X,{class:"pb-0"},{default:l(()=>[e(ne,{onSubmit:h(A,["prevent"])},{default:l(()=>[e(u,{modelValue:r.value.currentPassword,"onUpdate:modelValue":[a[2]||(a[2]=c=>r.value.currentPassword=c),a[3]||(a[3]=c=>k.value="")],"error-messages":k.value,label:"當前密碼",type:"password",variant:"outlined",density:"compact",class:"mb-4"},null,8,["modelValue","error-messages"]),e(u,{modelValue:r.value.newPassword,"onUpdate:modelValue":[a[4]||(a[4]=c=>r.value.newPassword=c),a[5]||(a[5]=c=>C.value="")],"error-messages":C.value,label:"新密碼",type:"password",variant:"outlined",density:"compact",class:"mb-4"},null,8,["modelValue","error-messages"]),e(u,{modelValue:r.value.confirmPassword,"onUpdate:modelValue":[a[6]||(a[6]=c=>r.value.confirmPassword=c),a[7]||(a[7]=c=>D.value="")],"error-messages":D.value,label:"確認新密碼",type:"password",variant:"outlined",density:"compact",class:"mb-4"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(ee,{class:"me-4 mb-3"},{default:l(()=>[e(le),e(V,{color:"grey-darken-1",variant:"outlined",size:z.value,onClick:E},{default:l(()=>a[33]||(a[33]=[t(" 取消 ")])),_:1},8,["size"]),e(V,{color:"red-darken-1",variant:"outlined",size:z.value,loading:f.value,onClick:A},{default:l(()=>a[34]||(a[34]=[t(" 確認修改 ")])),_:1},8,["size","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},we=Y(me,[["__scopeId","data-v-74b93c7d"]]);export{we as default};
