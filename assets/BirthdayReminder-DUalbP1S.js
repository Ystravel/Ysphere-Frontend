import{bu as j,p as E,bv as N,m as U,bh as H,Y as O,d as K,bw as W,bx as Z,e as q,a as G,f as J,by as Q,g as X,D as ee,o as P,l as te,bz as ae,bi as se,Z as le,j as ne,bA as oe,bB as re,k as ie,bd as ce,t as de,_ as ue,c as s,bC as me,ab as D,r as z,K as ve,H as ye,a0 as fe,a2 as be,x as I,z as ge,A as ke,a6 as r,ao as b,a8 as o,ai as _e,af as v,am as pe,ay as xe,U as A,ap as he,a7 as k,al as Ve,V as Ce,an as g,at as Pe,ad as _,aE as De}from"./index-E3kPulXX.js";import{a as Be,V as we}from"./VRow-BqY2S3LH.js";import{b as Se,V as ze,a as Ie}from"./VList-DMkt-Ftz.js";const Ae=j("v-alert-title"),Te=["success","info","warning","error"],Le=E({border:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:N,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>Te.includes(e)},...U(),...H(),...O(),...K(),...W(),...Z(),...q(),...G(),...J(),...Q({variant:"flat"})},"VAlert"),$e=X()({name:"VAlert",props:Le(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0},setup(e,p){let{emit:x,slots:a}=p;const c=ee(e,"modelValue"),i=P(()=>{if(e.icon!==!1)return e.type?e.icon??`$${e.type}`:e.icon}),d=P(()=>({color:e.color??e.type,variant:e.variant})),{themeClasses:h}=te(e),{colorClasses:V,colorStyles:y,variantClasses:n}=ae(d),{densityClasses:t}=se(e),{dimensionStyles:l}=le(e),{elevationClasses:u}=ne(e),{locationStyles:m}=oe(e),{positionClasses:T}=re(e),{roundedClasses:L}=ie(e),{textColorClasses:$,textColorStyles:F}=ce(de(e,"borderColor")),{t:R}=ue(),B=P(()=>({"aria-label":R(e.closeLabel),onClick(C){c.value=!1,x("click:close",C)}}));return()=>{const C=!!(a.prepend||i.value),M=!!(a.title||e.title),Y=!!(a.close||e.closable);return c.value&&s(e.tag,{class:["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${e.border===!0?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},h.value,V.value,t.value,u.value,T.value,L.value,n.value,e.class],style:[y.value,l.value,m.value,e.style],role:"alert"},{default:()=>{var w,S;return[me(!1,"v-alert"),e.border&&s("div",{key:"border",class:["v-alert__border",$.value],style:F.value},null),C&&s("div",{key:"prepend",class:"v-alert__prepend"},[a.prepend?s(z,{key:"prepend-defaults",disabled:!i.value,defaults:{VIcon:{density:e.density,icon:i.value,size:e.prominent?44:28}}},a.prepend):s(D,{key:"prepend-icon",density:e.density,icon:i.value,size:e.prominent?44:28},null)]),s("div",{class:"v-alert__content"},[M&&s(Ae,{key:"title"},{default:()=>{var f;return[((f=a.title)==null?void 0:f.call(a))??e.title]}}),((w=a.text)==null?void 0:w.call(a))??e.text,(S=a.default)==null?void 0:S.call(a)]),a.append&&s("div",{key:"append",class:"v-alert__append"},[a.append()]),Y&&s("div",{key:"close",class:"v-alert__close"},[a.close?s(z,{key:"close-defaults",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var f;return[(f=a.close)==null?void 0:f.call(a,{props:B.value})]}}):s(ve,ye({key:"close-btn",icon:e.closeIcon,size:"x-small",variant:"text"},B.value),null)])]}})}}}),Fe={key:0,class:"loading-overlay d-flex justify-center align-center"},Re={key:0,class:"birthday-list"},Me={class:"font-weight-medium",style:{"font-size":"14px"}},Ye={class:"text-caption text-grey-darken-1"},je={class:"text-center mt-4 text-grey-darken-1",style:{"font-size":"14px"}},Ee={class:"text-pink-lighten-1 font-weight-bold"},Ne={__name:"BirthdayReminder",setup(e,{expose:p}){const{apiAuth:x}=De(),a=be(),c=I([]),i=I(!1),d=n=>{const t=new Date;t.setHours(0,0,0,0);const l=new Date(n),u=t.getFullYear();l.setFullYear(u),l<t&&l.setFullYear(u+1);const m=l-t;return Math.ceil(m/(1e3*60*60*24))},h=n=>{const t=new Date(n),l=d(n);return l===0?`${t.getMonth()+1}/${t.getDate()} (今天)`:`${t.getMonth()+1}/${t.getDate()} (${l}天後)`},V=n=>{const t=d(n);return t>=0&&t<=13},y=async()=>{i.value=!0;try{const{data:n}=await x.get("/user/basic-info");n.success&&(c.value=n.result.data.filter(t=>t.employmentStatus==="在職"&&t.birthDate&&V(t.birthDate)).sort((t,l)=>d(t.birthDate)-d(l.birthDate)))}catch(n){console.error("載入壽星資料失敗:",n),a({text:"載入壽星資料失敗",snackbarProps:{color:"error"}})}finally{i.value=!1}};return p({refreshData:y}),ge(()=>window.location.href,()=>{y()}),ke(()=>{y()}),(n,t)=>(r(),b("div",null,[s(we,null,{default:o(()=>[s(Be,{cols:"12"},{default:o(()=>[s(_e,{class:"mx-auto px-8 py-6",elevation:"4",rounded:"lg"},{default:o(()=>[t[3]||(t[3]=v("h6",{class:"ps-1 mb-5 d-flex align-center"}," 近期壽星 ",-1)),s(pe,{class:"pt-0 px-1 birthday-container"},{default:o(()=>[i.value?(r(),b("div",Fe,[s(xe,{indeterminate:"",color:"blue-grey-darken-1"})])):(r(),b(A,{key:1},[c.value.length>0?(r(),b("div",Re,[s(Se,null,{default:o(()=>[(r(!0),b(A,null,he(c.value,l=>(r(),k(ze,{key:l._id,class:"mb-2 rounded-lg",variant:"outlined"},{prepend:o(()=>[s(Ve,{size:"36",color:"blue-grey-darken-1"},{default:o(()=>[l.avatar?(r(),k(Ce,{key:0,src:l.avatar,cover:""},null,8,["src"])):(r(),k(D,{key:1,icon:"mdi-account",color:"blue-grey-darken-1",size:"20"}))]),_:2},1024)]),default:o(()=>[s(Ie,{class:"d-flex justify-space-between align-center"},{default:o(()=>{var u,m;return[v("div",null,[v("span",Me,g(l.name),1),v("div",Ye,g(((u=l.department)==null?void 0:u.name)||"未分配部門")+"("+g((m=l.department)==null?void 0:m.departmentId)+") ",1)]),s(Pe,{size:"small",color:d(l.birthDate)===0?"pink-lighten-1":"teal-lighten-2",variant:"flat",class:"ms-2 font-weight-medium"},{default:o(()=>[_(g(h(l.birthDate)),1)]),_:2},1032,["color"])]}),_:2},1024)]),_:2},1024))),128))]),_:1}),v("div",je,[t[0]||(t[0]=_(" 未來兩週共 ")),v("span",Ee,g(c.value.length),1),t[1]||(t[1]=_(" 位壽星 "))])])):(r(),k($e,{key:1,color:"blue-grey-darken-1",variant:"tonal",class:"mb-0 mt-4"},{prepend:o(()=>[s(D,{icon:"mdi-information",size:"18",color:"blue-grey-lighten-1"})]),default:o(()=>[t[2]||(t[2]=_(" 未來兩週內無壽星 "))]),_:1}))],64))]),_:1})]),_:1})]),_:1})]),_:1})]))}},Ke=fe(Ne,[["__scopeId","data-v-bb053d09"]]);export{Ke as B};
