import{_ as y,Z as g,x as l,A as k,ai as C,c as o,a3 as t,b0 as _,$,a1 as B,a4 as E,a8 as c,as as P,aa as F,K as I,an as N}from"./index-ByucKqp8.js";import{V as R}from"./VContainer-oCNJNb7u.js";import{V as S}from"./VForm-BnK190cx.js";import{V as A,a as m}from"./VRow-OOr9qEfI.js";const M={id:"background",class:"fill-height d-flex justify-center align-center"},T={__name:"resetPassword",setup(U){const v=_(),w=$(),{api:b}=N(),f=g(),a=l({newPassword:"",confirmPassword:""}),i=l(!1),u=l(!1),n=l(""),d=l(""),p=l(!1);k(async()=>{v.params.token||(f({text:"無效的重置連結",snackbarProps:{color:"error"}}),w.push("/login"))});const x=()=>{let r=!0;return n.value="",d.value="",a.value.newPassword?a.value.newPassword.length<8&&(n.value="密碼長度至少需要8個字元",r=!1):(n.value="請輸入新密碼",r=!1),a.value.confirmPassword?a.value.newPassword!==a.value.confirmPassword&&(d.value="兩次輸入的密碼不相符",r=!1):(d.value="請確認新密碼",r=!1),r},V=async()=>{var r,e;if(x())try{p.value=!0;const{data:s}=await b.post("/user/reset-password",{token:v.params.token,newPassword:a.value.newPassword});f({text:s.message,snackbarProps:{color:"success"}}),w.push("/login")}catch(s){f({text:((e=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:e.message)||"重置密碼失敗",snackbarProps:{color:"error"}})}finally{p.value=!1}};return(r,e)=>(B(),C("div",M,[o(R,{class:"reset-password-wrapper pa-0",style:{"max-width":"360px"}},{default:t(()=>[o(S,{disabled:p.value,onSubmit:E(V,["prevent"])},{default:t(()=>[o(A,{class:"px-4 ma-0"},{default:t(()=>[o(m,{cols:"12",class:"text-center mt-4 font-weight-bold"},{default:t(()=>e[6]||(e[6]=[c(" 重置密碼 ")])),_:1}),o(m,{cols:"12"},{default:t(()=>[o(P,{modelValue:a.value.newPassword,"onUpdate:modelValue":[e[0]||(e[0]=s=>a.value.newPassword=s),e[2]||(e[2]=s=>n.value="")],"error-messages":n.value,type:i.value?"text":"password","append-inner-icon":i.value?"mdi-eye-off":"mdi-eye",label:"新密碼",density:"compact",variant:"underlined",autocomplete:"new-password","onClick:appendInner":e[1]||(e[1]=s=>i.value=!i.value)},null,8,["modelValue","error-messages","type","append-inner-icon"])]),_:1}),o(m,{cols:"12"},{default:t(()=>[o(P,{modelValue:a.value.confirmPassword,"onUpdate:modelValue":[e[3]||(e[3]=s=>a.value.confirmPassword=s),e[5]||(e[5]=s=>d.value="")],"error-messages":d.value,type:u.value?"text":"password","append-inner-icon":u.value?"mdi-eye-off":"mdi-eye",label:"確認新密碼",density:"compact",variant:"underlined",autocomplete:"new-password","onClick:appendInner":e[4]||(e[4]=s=>u.value=!u.value)},null,8,["modelValue","error-messages","type","append-inner-icon"])]),_:1}),o(m,{cols:"12",class:"pb-8"},{default:t(()=>[e[8]||(e[8]=F("div",{class:"text-body-2 text-medium-emphasis mb-6"}," 新密碼必須至少8個字元 ",-1)),o(I,{block:"",elevation:"2",color:"orange-darken-1",type:"submit",loading:p.value,disabled:!a.value.newPassword||!a.value.confirmPassword},{default:t(()=>e[7]||(e[7]=[c(" 重置密碼 ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1})]))}},z=y(T,[["__scopeId","data-v-e19d530a"]]);export{z as default};
